{"componentChunkName":"component---node-modules-gatsby-theme-apollo-docs-src-components-template-js","path":"/security/authorization/","result":{"data":{"site":{"pathPrefix":"","siteMetadata":{"title":"akv2k8s docs","description":"How to get Azure Key Vault objects into Kubernetes"}},"file":{"childMarkdownRemark":{"frontmatter":{"title":"Authorization","description":"Learn how to set the proper access rights to access Azure Key Vault secrets from Kubernetes."},"headings":[],"fields":{"image":"social-cards/authorization.png","graphManagerUrl":""},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"No matter which authentication option is used, the authenticated account will need "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"get"}]},{"type":"text","value":" permissions to the different object types in Azure Key Vault."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Note: It's only possible to control access at the top level of Azure Key Vault, not per object/resource. The recommendation is therefore to have a dedicated Key Vault per cluster."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Access is controlled through Azure Key Vault policies and can be configured through Azure CLI like this:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Azure Key Vault Secrets:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"az keyvault set-policy "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  -n "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure key vault name"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --secret-permissions get "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --spn "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"service principal id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":" \n  --subscription "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure subscription"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Azure Key Vault Certificates:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"az keyvault set-policy "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  -n "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure key vault name"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --certificate-permissions get "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --spn "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"service principal id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --subscription "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure subscription"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Azure Key Vault Keys:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-bash","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"az keyvault set-policy "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  -n "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure key vault name"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --key-permissions get "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --spn "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"service principal id"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\\"}]},{"type":"text","value":"\n  --subscription "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"azure subscription"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Note: The Env Injector needs to be anabled for each namespace"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Env Injector is developed using a Mutating Admission Webhook that triggers just before every Pod gets created. To allow cluster administrators some control over which Pods this Webhook gets triggered for, it must be enabled per namespace using the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"azure-key-vault-env-injection"}]},{"type":"text","value":" label, like in the example below:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"style":"counter-reset: linenumber NaN","className":["language-yaml","line-numbers"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Namespace\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" akv"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"test\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"azure-key-vault-env-injection"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" enabled"}]},{"type":"element","tagName":"span","properties":{"ariaHidden":"true","className":["line-numbers-rows"],"style":"white-space: normal; width: auto; left: 0;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]},{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}],"data":{"quirksMode":false}}},"childMdx":null}},"pageContext":{"id":"65c9c43c-2ab6-5259-add7-e9efb8f60b37","subtitle":"","versionDifference":0,"versionBasePath":"/v1.0.0","sidebarContents":[{"title":null,"pages":[{"title":"Introduction","description":"Explore Azure Key Vault to Kubernetes","path":"/"},{"title":"Why use akv2k8s?","description":null,"path":"/why-akv2k8s/"},{"title":"Quick Start","description":"Quickly get started using Azure Key Vault to Kubernetes","path":"/quick-start/"},{"title":"How it Works","description":"Learn about the inner workings of akv2k8s.","path":"/how-it-works/"},{"title":"Examples","description":"Different examples of how akv2k8s can be used.","path":"/examples/"}]},{"title":"Installation","pages":[{"title":"Introduction","description":"Different options for installing akv2k8s","path":"/installation/introduction/"},{"title":"Requirements","description":"Requirements for installing akv2k8s","path":"/installation/requirements/"},{"title":"Installation with Helm","description":"How to install Azure Key Vault to Kubernetes with Helm","path":"/installation/installing-with-helm/"},{"title":"Installation without Helm","description":"How to setup Azure Key Vault to Kubernetes","path":"/installation/installing-without-helm/"}]},{"title":"Tutorials","pages":[{"title":"Introduction","description":"kjadsl ","path":"/tutorials/introduction/"},{"title":"Prerequisites","description":"A set of commands to create all prerequisite resources needed to complete tutorials","path":"/tutorials/prerequisites/"},{"title":"Sync Secret","description":"Sync a secret from Azure Key Vault into a Kubernetes Secret","path":"/tutorials/sync/1-secret/"},{"title":"Sync Certificate","description":"Sync a certificate from Azure Key Vault into a Kubernetes Secret.","path":"/tutorials/sync/2-certificate/"},{"title":"Sync Signing Key","description":"Sync signing key from Azure Key Vault into a Kubernetes Secret","path":"/tutorials/sync/3-signing-key/"},{"title":"Sync Multi Value Secret","description":"Sync a multi-value secret from Azure Key Vault into a Kubernetes Secret","path":"/tutorials/sync/4-multi-value-secret/"},{"title":"Inject Secret","description":"Inject a Azure Key Vault secret as environment variable into an application","path":"/tutorials/env-injection/1-secret/"},{"title":"Inject Certificate","description":"Inject a certificate key pair from Azure Key Vault as environment variables into an application","path":"/tutorials/env-injection/2-certificate/"},{"title":"Inject Signing Key","description":"Inject a signing key from Azure Key Vault as environment variable into an application","path":"/tutorials/env-injection/3-signing-key/"},{"title":"Inject Multi Value Secret","description":"Inject a multi-value secret from Azure Key Vault as environment variables into an application","path":"/tutorials/env-injection/4-multi-value-secret/"},{"title":"Inject PFX Certificate","description":"Inject PFX certificates from Azure Key Vault as environment variables into an application","path":"/tutorials/env-injection/5-env-injector-pfx-certificate/"}]},{"title":"Security","pages":[{"title":"Authentication","description":"Learn about the different options for authenticating with Azure Key Vault.","path":"/security/authentication/"},{"title":"Authorization","description":"Learn how to set the proper access rights to access Azure Key Vault secrets from Kubernetes.","path":"/security/authorization/"}]},{"title":"Scaling and Availability","pages":[]},{"title":"Troubleshooting","pages":[{"title":"Get the akv2k8s Controller Log","description":"How to access the Controller log and specify log level","path":"/troubleshooting/controller-log/"},{"title":"Set env-injector log-level","description":"How to set the log-level for the env-injector","path":"/troubleshooting/env-injector-log-level/"},{"title":"Known Issues","description":"A list of known issues and available solutions or workarounds","path":"/troubleshooting/known-issues/"}]},{"title":"Reference","pages":[{"title":"AzureKeyVaultSecret","description":"See the complete reference and options for all akv2k8s resources.","path":"/reference/reference/"},{"title":"Vault Object Types","description":"See the complete reference and options for all akv2k8s resources.","path":"/reference/vault-object-types/"},{"title":"Kubernetes Secret Types","description":"See the complete reference and options for all akv2k8s resources.","path":"/reference/kubernetes-secret-types/"}]}],"githubUrl":"https://github.com/sparebankenvest/azure-key-vault-to-kubernetes/tree/master/docs/source/content/security/authorization.md","spectrumUrl":"","twitterHandle":"","versions":["0.1.15"],"defaultVersion":"1.0.0","baseUrl":"https://akv2k8s.io"}}}